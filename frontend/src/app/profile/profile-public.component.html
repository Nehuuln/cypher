<div class="profile-page">
  <div class="profile-header-bar">
    <div class="header-info">
      <h2>Recherche</h2>
    </div>
  </div>

  <div class="public-profile-container">
    <div class="search-section">
      <div class="search-bar">
        <svg viewBox="0 0 24 24" width="18" height="18" fill="#536471" style="margin-left: 12px">
          <path
            d="M10.25 3.75c-3.59 0-6.5 2.91-6.5 6.5s2.91 6.5 6.5 6.5c1.795 0 3.419-.726 4.596-1.904 1.178-1.177 1.904-2.801 1.904-4.596 0-3.59-2.91-6.5-6.5-6.5zm-8.5 6.5c0-4.694 3.806-8.5 8.5-8.5s8.5 3.806 8.5 8.5c0 1.986-.73 3.815-1.945 5.232l4.95 4.95-1.414 1.414-4.95-4.95C14.065 18.02 12.236 18.75 10.25 18.75c-4.694 0-8.5-3.806-8.5-8.5z"
          ></path>
        </svg>
        <input
          [(ngModel)]="tagInput"
          placeholder="Chercher un tag (ex: monTag_01)"
          class="search-input-field"
          (keydown.enter)="viewByTag()"
        />
      </div>
      <button (click)="viewByTag()" [disabled]="loading" class="action-btn search-btn">Voir</button>
    </div>

    <div *ngIf="loading" class="loading-msg">Chargement...</div>
    <div *ngIf="error" class="error-msg">{{ error }}</div>

    <div *ngIf="profile" class="profile-result-card">
      <h3 class="result-heading">Mon profil</h3>

      <div class="profile-cover"></div>

      <div class="profile-details-container">
        <div class="profile-top-row">
          <img
            *ngIf="avatarUrl"
            [src]="avatarUrl"
            class="profile-avatar-lg"
            crossorigin="use-credentials"
            (error)="$event.target.style.display = 'none'"
          />
          <div *ngIf="!avatarUrl" class="profile-avatar-lg" style="background: #e1e8ed"></div>

          <button *ngIf="isOwner()" class="edit-profile-btn" (click)="editProfile()">
            Ã‰diter le profil
          </button>
        </div>

        <div class="profile-name">{{ profile.username }}</div>
        <div class="profile-handle">@{{ profile.tag }}</div>

        <div class="profile-bio" *ngIf="profile.bio">{{ profile.bio }}</div>

        <div class="profile-meta">
          <div class="meta-item">
            <svg viewBox="0 0 24 24" width="18" height="18">
              <path
                d="M7 4V3h2v1h6V3h2v1h1.5C19.89 4 21 5.12 21 6.5v12c0 1.38-1.11 2.5-2.5 2.5h-13C4.12 21 3 19.88 3 18.5v-12C3 5.12 4.12 4 5.5 4H7zm0 2H5.5c-.27 0-.5.22-.5.5v12c0 .28.23.5.5.5h13c.28 0 .5-.22.5-.5v-12c0-.28-.22-.5-.5-.5H17v1h-2V6H9v1H7V6zm0 6h2v-2H7v2zm0 4h2v-2H7v2zm4-4h2v-2h-2v2zm0 4h2v-2h-2v2zm4-4h2v-2h-2v2z"
              ></path>
            </svg>
            <span>Inscrit le {{ profile.createdAt | date : 'shortDate' }}</span>
          </div>
        </div>
      </div>

      <div class="profile-tabs">
        <div class="tab-item active">Publications</div>
        <div class="tab-item">J'aime</div>
      </div>
    </div>
  </div>
</div>
